# Claude Code SDK


* Claude Code SDK는 **AI 기반 코딩 도구**를 애플리케이션에 통합할 수 있는 기능 제공
* 개발자는 **서브프로세스 형태로 Claude Code 실행** 가능, 커맨드라인 사용 우선 지원
* **대화형 컨텍스트 관리**, 커스텀 시스템 프롬프트 지정, 외부 도구 연동(MCP) 기능 포함
* **출력 포맷 다양성**(텍스트, JSON, 스트리밍 JSON) 및 상세한 CLI 옵션 활용 가능
* 실제 사례로 GitHub Actions와 연계하여 자동화된 코드 리뷰, PR 생성 등 **실제 개발 워크플로우 통합** 가능성 제시

---

소개
--

Claude Code SDK는 **Claude Code의 기능**을 애플리케이션에 직접 프로그래밍적으로 통합할 수 있는 오픈소스 개발 도구임. SDK는 Claude Code를 **별도 프로세스 형태로 실행**하여, AI 기반 코드 어시스턴트, 자동화 도구, 코드 리뷰 시스템 등 다양한 개발 워크플로우에 접목할 수 있는 확장성을 제공함.

현재는 커맨드라인(CLI) 기반 인터페이스를 지원하며, TypeScript 및 Python용 SDK는 곧 출시될 예정임

기본 SDK 사용
---------

Claude Code SDK는 **비대화형(비인터랙티브) 실행**을 지원함. 예를 들어, 프로그래밍 코드 내에서 Claude Code를 명령줄 인수와 함께 호출하여 원하는 출력을 자동으로 얻을 수 있음

고급 사용법
------

### 멀티턴 대화 세션 이어가기

* 여러 차례의 대화를 주고받을 때, 이전의 세션이나 특정 세션 ID를 활용하여 **대화 맥락을 유지**하고 이어가는 기능 제공
* 개발자는 최근 세션에서 대화를 계속 이어가거나, 특정 세션을 불러올 수 있음

### 커스텀 시스템 프롬프트

* Claude의 기본 동작 방식을 **개발자 맞춤형 시스템 프롬프트**로 조정 가능
* 기본 시스템 프롬프트에 추가 지침을 첨부하여 assistant의 업무 지향성과 행동 범위를 변경할 수 있음

### MCP(Model Context Protocol) 설정

* **MCP는 Claude Code 기능 확장**을 위한 외부 서버 연동 프로토콜임
* `--mcp-config` 플래그와 JSON 설정 파일을 통해 외부 서버에서 제공하는 **데이터베이스 접근, API 연동, 커스텀 툴** 등을 추가할 수 있음
* MCP 도구 사용 시, 명시적으로 허용한 도구만 사용 가능해야 하며(`--allowedTools` 플래그), 이름 패턴이 `mcp__<serverName>__<toolName>` 형식임

사용 가능한 CLI 옵션
-------------

Claude Code SDK에서는 **다양한 커맨드라인 플래그**를 사용하여 실행 환경을 설정할 수 있음

* `--print`, `-p` : 비인터랙티브 모드 실행
* `--output-format` : 출력 포맷 선택(텍스트, JSON, 스트림 JSON 등)
* `--resume`, `-r` : 특정 세션 ID로 대화 이어가기
* `--continue`, `-c` : 가장 최근 세션 이어가기
* `--verbose` : 상세 로그 출력
* `--max-turns` : 비인터랙티브 모드에서 최대 대화 라운드 제한
* `--system-prompt` : 시스템 프롬프트 오버라이드
* `--append-system-prompt` : 시스템 프롬프트에 추가 지침 첨부
* `--allowedTools` : 허용 도구 리스트 지정(MCP 도구도 포함)
* `--disallowedTools` : 금지 도구 리스트 지정
* `--mcp-config` : MCP 서버 설정 파일 로드
* `--permission-prompt-tool` : 권한 프롬프트 처리를 위한 MCP 도구 지정

전체 사용 가능한 옵션 및 사용 예시는 공식 [CLI 문서](/en/docs/claude-code/cli-usage) 참고 필요

출력 포맷
-----

SDK는 다양한 **출력 포맷**을 지원함

### 텍스트 출력(기본)

* 응답 텍스트만 반환

### JSON 출력

* **메타데이터와 구조화된 데이터** 반환으로 프로그래밍적 파싱에 유리
* API 응답 메시지는 엄격한 타입 구조를 따르며, 앞으로 JSON Schema 포맷으로도 타입 정의 예정

### 스트리밍 JSON 출력

* 각 메시지를 **실시간으로 스트림 전송**
* 대화 세션 진행 시, 초기화 메시지(`init`), 사용자/assistant 메시지, 통계가 들어있는 최종 `result` 메시지 순으로 별도 JSON 객체로 전송

메시지 스키마
-------

* JSON API 응답 메시지는 **정확한 스키마**에 따라 구조화됨
* 주기적으로 스키마 갱신 및 버전 관리 진행 예정

예시
--

* 간단한 스크립트 통합
* Claude를 활용한 파일 처리
* **세션 관리**로 복잡한 대화 플로우 지원

베스트 프랙티스
--------

1. **JSON 출력 포맷**을 활용한 응답 파싱 사용
2. **오류 처리**: 종료 코드 및 에러 스트림 확인
3. **세션 관리**: 다중 라운드 대화의 맥락 유지
4. **타임아웃 고려**: 장시간 작업의 안전성 확보
5. **요청 간 간격 조정**: 과다한 호출 방지 및 서비스 안정성 유지

실제 적용 사례
--------

Claude Code SDK는 실무 개발 환경에서 **강력한 자동화 및 통합** 기능을 제공함

* 대표적 사례로, GitHub Actions와 결합하여 **자동 코드 리뷰, PR 생성, 이슈 분류 등**의 개발 워크플로우를 완전 자동화할 수 있음
