# Grammarly 확장의 배신


Grammarly 확장 프로그램이 웹사이트를 깨뜨린 이유
-------------------------------

* 최근 몇 달 동안 웹사이트 레이아웃이 **이상하게 깨졌다는 보고**를 종종 받았음
* 문제의 원인은 **Grammarly 브라우저 확장 프로그램**으로 밝혀졌고, 이를 확인하기 위해 본인도 직접 설치해봄

문제 발견 과정
--------

* Grammarly 확장 프로그램은 다음과 같은 권한을 요청함:
  + 모든 웹사이트의 데이터 접근
  + 알림 표시
  + 브라우저 탭 접근
* Firefox에서 실험한 결과, Grammarly는 웹페이지에 **자체 스타일시트**를 삽입함
  + 이 스타일시트는 웹페이지에서 직접 탐지할 수 없음 (숨겨진 스타일시트)
  + Content Security Policy까지 우회함
* `<html>` 태그 안에 `<grammarly-desktop-integration>` 요소도 삽입됨 (목적은 불분명)

왜 내 사이트였나?
----------

* Grammarly의 스타일시트 끝에 다음 코드가 포함되어 있음:

  ```
  :host,  
  :root {  
    --rem:16  
  }  

  ```
* 이 설정은 기본 CSS 단위인 1rem = 16px와 겹치며, 저자도 --rem이라는 커스텀 프로퍼티를 사용 중이었음
* Grammarly는 고정된 --rem 값을 전역으로 설정하고, 동적 폰트 사이징을 시도함
* 이로 인해 저자의 유동적인 타이포그래피 계산이 깨짐

저자의 대응
------

* 처음에는 Mutation Observer를 이용해 Grammarly가 삽입한 요소를 감지하고 !important 스타일로 덮어씀
* 이후 자신의 CSS 변수명을 --rem에서 \*\*--🤡 (유니코드 이모지)\*\*로 변경함
* 이모지는 CSS 변수 이름으로 유효함
* 이렇게 하면 Grammarly의 전역 --rem 설정과 충돌을 피할 수 있음

문제의 본질
------

* Grammarly는 웹 확장 프로그램으로서 모든 웹사이트에 전역 스타일을 강제로 삽입함
* 특히 --rem처럼 일반적인 CSS 변수명을 사용하는 것은 매우 해로움
* 코드 내부에서는 무작위 클래스명을 쓰면서도, 왜 굳이 공용 네이밍을 전역으로 적용했는지 이해할 수 없음
* 실제 확장을 사용하지 않아도 코드가 삽입됨

결론 및 제안
-------

* 저자는 Grammarly에 문의했으며, 빠른 응답은 있었지만 기술적으로 문제를 이해하는 담당자와 연결되지는 못함
* 이상적인 해결책은 Grammarly가 --🤡 같은 변수명을 사용하고, 나머지 개발자들이 자유롭게 --rem을 사용할 수 있도록 하는 것임
