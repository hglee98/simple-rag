# 스타링크 사용자 터미널 분해


* **SpaceX**의 **스타링크 사용자 터미널**은 지구 저궤도 위성 인터넷 연결의 핵심 하드웨어임
* 사용자 단말기를 분해해보면, **무선 주파수(RF) 프런트엔드**와 **자체 설계 SoC**가 주요 부품임
* 펌웨어 분석 결과, 대부분의 핵심 소프트웨어는 **커널 우회 사용자 공간 네트워크 처리** 및 일부 암호화 기능을 포함함
* **STSAFE-A110** 보안 칩이 추가 인증 루트 역할을 하며, 데이터 암호화 및 고유 식별 제공임
* 이 터미널에는 다수의 **SSH 공개키** 설정과 의심스러운 패킷 기록 도구가 포함되어 있으나, 사용자 프라이버시 침해 단서는 나타나지 않음

---

개요
--

* 스타링크는 **SpaceX**가 제공하는 **저궤도 위성 인터넷 서비스**임
* 사용자는 터미널을 통해 인근 위성에 접속하며, 이는 지상 게이트웨이를 통해 인터넷으로 연결됨
* 신세대 위성은 **레이저 링크**를 활용해 위성 간 통신이 가능해지며, 이 기능은 글로벌 커버리지 및 효율성 향상에 기여함
* 현지 게이트웨이 없이도, 예를 들어 우크라이나와 같이, 인접국 게이트웨이를 이용해 **스타링크 단말기**가 인터넷에 접속할 수 있음
* 본 기사에서는 **DARKNAVY**의 스타링크 사용자 터미널 심층 조사 내용을 간략히 다룸

하드웨어 분석
-------

* 하나의 **스타링크 사용자 터미널**은 **라우터**와 **안테나(UTA)** 두 부분으로 구성됨
* DARKNAVY는 싱가포르에서 Standard Actuated(Rev3, GenV2) 터미널을 구매해 **안테나를 분해**함
* 분해 결과, **RF 프런트엔드 칩(주로 STMicroelectronics 생산)** 이 보드 상당 부분을 차지하고 있었음
* 핵심 제어 영역엔 **SpaceX 전용 커스텀 ST SoC(쿼드코어 Cortex-A53)** 가 탑재되어 있으나, 데이터시트 정보는 비공개임
* **Black Hat USA 2022**에서 KU Leuven 소속 Lennert Wouters 박사는 1세대 터미널(GenV1) 해킹 성공 사례를 발표했고, SpaceX는 이후 펌웨어 업데이트로 **UART 디버그 인터페이스**를 비활성화했음
* 하지만 추가적인 방법으로 보안 우회가 재차 성공된 이력이 있음

펌웨어 추출 및 분석
-----------

* DARKNAVY는 **eMMC 칩**에서 직접 펌웨어를 덤프함
* Rev3 보드에는 별도 eMMC 디버그 핀이 없어, **eMMC를 분리 후 프로그래머로 데이터 추출** 방식 활용함
* 대부분의 펌웨어는 암호화되지 않아, **부트체인(BootROM 제외), 커널, 파일시스템 일부**가 드러남
* 커널 부팅 후에는 런타임 환경을 **/sx/local/runtime**으로 풀어 활용함
* `bin`에는 스타링크 소프트웨어 실행 파일들이, `dat`에는 설정 파일, `revision_info`에는 버전 정보가 들어있음
* 핵심 통신 프로그램 `user_terminal_frontend`는 Go로 개발되어 있고, 그 외 대부분은 심볼 없는 정적 C++ 바이너리임
* **네트워크 스택 아키텍처**가 **DPDK**와 유사하게 커널을 우회해 사용자 공간 프로그램이 패킷 처리를 담당함
* 리눅스 커널은 주로 하드웨어 드라이버 및 프로세스 관리용임
* 일부 소프트웨어에는 원래 **위성 혹은 게이트웨이 용도**로 설계된 기능이 포함되어 있음
* 기기 부팅 시 하드웨어 주변장치로 타입을 식별한 뒤, 해당 로직만 로드해 사용함

에뮬레이션
-----

* 지속적 분석을 위해 QEMU 기반 **Rev3 펌웨어 에뮬레이션 환경**을 구축함
* 이 환경에서 `httpd`, `WebSocket`, `gRPC` 등 대외 서비스 일부를 실행하고 디버깅하는 데 성공함
* 주요 실행파일 및 서비스의 작동 원리를 추적 가능해짐

보안칩
---

* 메인 SoC 외에 **STSAFE-A110** 보안칩이 존재하며, **CC EAL5+** 인증을 주장함
* 해당 칩은 NDA에서 구매 가능하고, 펌웨어의 **stsafe\_cli** 프로그램이 이 칩과 상호작용함
* 분석 결과 STSAFE 칩이 제공하는 기능으로는 **기기 고유 UUID 부여, 공개키 인증서(stsafe\_leaf.pem) 관리, 대칭 키 도출** 등이 있음
* 이 칩은 SoC의 보안 부트와 별개의 **추가 신뢰 루트**로, 현대 임베디드 보안 설계 기준에 부합함

이스터에그: Elon이 당신을 지켜보는가?
-----------------------

* 분석 중 **Ethernet Data Recorder** 프로그램이 확인되어, **백도어 가능성**에 대한 의문을 자아냄
* 이 프로그램은 패킷 기록 기능이 있어 보이며, 내부적으로 **pcap\_filter 유사 매커니즘**으로 특정 패킷을 캡처함
* 규칙을 보면, 캡처 대상은 주로 **위성 텔레메트리 관련 UDP 패킷** 임을 알 수 있음
* 포착한 트래픽은 **SoC 하드웨어 키**로 암호화되어 저장됨
* 현재까지 사용자 프라이버시 데이터를 수집하는 증거는 확인되지 않음
* 초기화 과정에서 기기가 사용자 단말로 인식되면 **/root/.ssh/authorized\_keys**에 41개의 SSH 공개키가 기록되고, 포트 22는 항상 로컬 네트워크에 열려 있음
* 상용 제품에 다수의 미상 공개키가 등록되는 점은 주목할 만함

결론 및 전망
-------

* 위성 기술이 다양한 산업 분야에 적용됨에 따라, **스타링크와 같은 위성 인터넷 시스템 구성요소**는 향후 보안 공격 및 방어의 핵심 전장이 될 것으로 예상됨
* 우주 보안의 특성상, 한번의 실수가 **대상과의 영구 통신 두절**로 이어질 수 있으므로 신중한 접근이 요구됨
